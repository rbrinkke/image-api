# Image Processor Service - Environment Configuration
# Copy this file to .env and configure for your environment

# =============================================================================
# OAUTH 2.0 RESOURCE SERVER CONFIGURATION
# =============================================================================
# The image-api acts as an OAuth 2.0 Resource Server
# Tokens are validated locally using the auth-api's public JWKS endpoint

# Auth-API Configuration
AUTH_API_ISSUER_URL=http://auth-api:8000
AUTH_API_JWKS_URL=http://auth-api:8000/.well-known/jwks.json

# Expected audience for this service (must match token's "aud" claim)
AUTH_API_AUDIENCE=image-api

# JWT Algorithm (RS256 for asymmetric key validation)
JWT_ALGORITHM=RS256

# JWKS cache TTL (how often to refresh public keys from auth-api)
JWKS_CACHE_TTL=3600  # 1 hour

# =============================================================================
# BACKWARD COMPATIBILITY (DEPRECATED)
# =============================================================================
# Old symmetric key (deprecated - only for testing with old tokens)
JWT_SECRET_KEY=change-this-in-production  # DEPRECATED: Use OAuth 2.0 tokens

# =============================================================================
# STORAGE BACKEND
# =============================================================================
# Options: "local" (filesystem) or "s3" (AWS S3)
STORAGE_BACKEND=local

# Local Storage Configuration
STORAGE_PATH=/data/storage

# S3 Storage Configuration (uncomment if using S3)
# STORAGE_BACKEND=s3
# AWS_REGION=eu-west-1
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key

# =============================================================================
# DATABASE
# =============================================================================
DATABASE_PATH=/data/processor.db

# =============================================================================
# REDIS
# =============================================================================
REDIS_URL=redis://redis:6379/0

# =============================================================================
# RATE LIMITING
# =============================================================================
RATE_LIMIT_MAX_UPLOADS=50
RATE_LIMIT_WINDOW_MINUTES=60

# =============================================================================
# UPLOAD CONSTRAINTS
# =============================================================================
MAX_UPLOAD_SIZE_MB=10
ALLOWED_MIME_TYPES=["image/jpeg","image/png","image/webp"]

# =============================================================================
# IMAGE PROCESSING
# =============================================================================
WEBP_QUALITY=85

# Image sizes (max dimensions in pixels)
# IMAGE_SIZES={"thumbnail":150,"medium":600,"large":1200,"original":4096}

# =============================================================================
# SERVICE CONFIGURATION
# =============================================================================
SERVICE_NAME=image-processor
VERSION=1.0.0
ENVIRONMENT=development

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================
# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# JSON logging: true for production (structured logs), false for development (pretty console)
LOG_JSON=true

# Debug mode: enables additional debug features and pretty console output
DEBUG=false

# Development mode examples:
# DEBUG=true LOG_JSON=false  # Pretty console output with colors
# DEBUG=false LOG_JSON=true  # JSON structured logs (production-ready)

# Production mode:
# ENVIRONMENT=production LOG_LEVEL=INFO LOG_JSON=true DEBUG=false
